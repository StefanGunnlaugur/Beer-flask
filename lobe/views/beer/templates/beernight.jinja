{% extends "__base.jinja" %}

{% block body %}
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: none;">
			<symbol id="star"><g transform="scale(0.03125 0.03125)"><path d="M896 384l-313.5-40.781-134.5-279.219-134.531 279.219-313.469 40.781 230.469 208.875-59.469 303.063 277-148.812 277.062 148.812-59.562-303.063 230.5-208.875z" /></g></symbol>
			<symbol viewBox="0 0 18 18" id="no_rating"><g transform="scale(0.017578125 0.017578125)"><path d="M512 56.889c-251.362 0-455.111 203.749-455.111 455.111s203.749 455.111 455.111 455.111 455.111-203.749 455.111-455.111-203.749-455.111-455.111-455.111zM170.667 512c0-73.639 23.666-141.694 63.472-197.527l475.388 475.388c-55.833 39.806-123.888 63.472-197.527 63.472-188.222 0-341.333-153.111-341.333-341.333zM789.861 709.527l-475.388-475.388c55.833-39.806 123.888-63.472 197.527-63.472 188.222 0 341.333 153.111 341.333 341.333 0 73.639-23.666 141.694-63.472 197.527z" /></g></symbol>
	</svg>
    <link rel="stylesheet" href="{{ url_for("static", filename = 'css/radio--rating.css') }}">
    <link rel="stylesheet" href="{{ url_for("static", filename = 'css/heartbox-fav.css') }}">
    <div class="beer-containter col">
        <div class="beer-header mb-10">
            <p class="h2">{{beernight.name}}</p>
        </div>
        <div class="row">
            <div class="col-4 text-center">
                <img class='img-responsive mh-100 mw-100' src={{ url_for("static", filename = 'images/roundlogo.png') }} alt={{ beernight.name }} />
            </div>
            <div class="col-8">
                {% if beers|length > 0 %}
                    <ul id="beerListUL">
                            {% for b in beers %}
                                <li class="my-2 row">
                                    {{macros.beernight_beer_line(b, b.orginal_beer, beernight, b.get_user_rating(current_user.id), current_user)}}
                                </li>
                            {% endfor %}
                        </ul>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    {{super()}}
    
    <script>
        function postBeerRating(value, type, beer_id) {
            var action = $("#ratingForm-"+type+"_"+beer_id).attr("action");
            var xhr = new XMLHttpRequest();
            xhr.onload = function(e) {
                if(this.readyState === XMLHttpRequest.DONE) {
                    if(xhr.status == '200'){
                        var response = JSON.parse(xhr.responseText);
                    } else{
                        promptError("Villa koma upp:", xhr.responseText, "");
                    }
                }
            }
            let formData = new FormData();
            formData.append("value", value);
            formData.append("type", type);
            xhr.open("POST", action, true);
            xhr.send(formData);
        }
    </script>
{% endblock %}